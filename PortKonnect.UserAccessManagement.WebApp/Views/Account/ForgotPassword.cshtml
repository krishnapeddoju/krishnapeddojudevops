@{

 Layout = "~/Views/Shared/_eGateLayoutForPassword.cshtml";
}
@{
    ViewBag.Title = "ChangePassword";

    var IsFirstTimeLogin = "N";
    var PassWord="";
    var UserName="";
    var LogTransId="";

    if (!string.IsNullOrEmpty(ViewBag.PassWord))
    {
        PassWord = ViewBag.PassWord;

    }
if (!string.IsNullOrEmpty(ViewBag.UserName))
    {
        UserName = ViewBag.UserName;

    }
if (!string.IsNullOrEmpty(ViewBag.LogTransId))
    {
        LogTransId = ViewBag.LogTransId;

    }
}

@section scripts{
<script src="~/Scripts/Lib/angular.min.js"></script>
<script src="~/Scripts/Application/Model/ChangePasswordModel.js"></script>
<script src="~/Scripts/Application/ViewModel/ChangePasswordViewModel.js"></script>
}
@section ko_apply
{
    var viewModel = new eGateRoot.ChangePasswordViewModel("@IsFirstTimeLogin");	 
    ko.applyBindingsWithValidation(viewModel, $("#ChangePassword")[0], { insertMessages: false, messagesOnModified: false, grouping: { deep: true }});
}

<style>
    .input-help {
        display: none;
        /*position:absolute;*/
        z-index: 100;
        top: -27px;
        left: -200px;
        width: 300px;
        padding: 10px;
        background: #fefefe;
        font-size: .875em;
        border-radius: 5px;
        box-shadow: 0 1px 3px #aaa;
        border: 1px solid #ddd;
        opacity: 0.9;
    }

        .input-help::before {
            content: "\25C0";
            position: absolute;
            top: 10px;
            left: -12px;
            font-size: 16px;
            line-height: 16px;
            color: #ddd;
            text-shadow: none;
        }

        .input-help h4 {
            margin: 0;
            padding: 0;
            font-weight: normal;
            font-size: 1.1em;
        }

    /* Always hide the input help when it's pristine */
    input.ng-pristine + .input-help {
        display: none;
    }

    /* Hide the invalid box while the input has focus */
    .ng-invalid:focus + .input-help {
        display: none;
    }

    /* Show a blue border while an input has focus, make sure it overrides everything else */
    /* Overriding Twitter Bootstrap cuz I don't agree we need to alarm the user while they're typing */
    input:focus {
        color: black !important;
        border-color: rgba(82, 168, 236, 0.8) !important;
        -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6) !important;
        -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6) !important;
        box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6) !important;
    }


    /* Show green border when stuff has been typed in, and its valid */
    .ng-dirty.ng-valid {
        border-color: #ccc;
    }

    /* Show red border when stuff has been typed in, but its invalid */
    .ng-dirty.ng-invalid {
        border-color: #ec3f41;
    }

    .immediate-help {
        display: block;
        width: 20%;
        font-size: 13px;
        color: #555;
        vertical-align: middle;
        background-color: white;
        background-image: none;
        border-radius: 4px;
    }

        /* Show the help box once it has focus */
        .immediate-help:focus + .input-help {
            position: relative;
            margin-left: 450px;
            display: block;
        }

        /* Immediate help should be red when pristine */
        .immediate-help.ng-pristine:focus + .input-help {
            border-color: #ec3f41;
        }

            .immediate-help.ng-pristine:focus + .input-help::before {
                color: #ec3f41;
            }

    .input-help::before {
        display: none;
    }

    /* Help hould be green when input is valid */
    .ng-valid + .input-help {
        border-color: #3a7d34;
    }

        .ng-valid + .input-help::before {
            color: #3a7d34;
        }

    /* Help should show and be red when invalid */
    .ng-invalid + .input-help {
        display: block;
        /*position:relative;*/
        /*margin-left: 450px;*/
        border-color: #ec3f41;
    }

        .ng-invalid + .input-help::before {
            color: #ec3f41;
        }

    /* Style input help requirement bullets */
    .input-help ul {
        list-style: none;
        margin: 10px 0 0 0;
    }

    /* Default each bullet to be invalid with a red cross and text */
    .input-help li {
        padding-left: 22px;
        line-height: 24px;
        color: #ec3f41;
        background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAA1CAYAAABIkmvkAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAJwAAACcBKgmRTwAAABZ0RVh0Q3JlYXRpb24gVGltZQAxMC8wOS8xMlhq+BkAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzVxteM2AAAEA0lEQVRIie2WW2jbVRzHv//zT5rkn0ub61zaNdEiPqTC9EFRhtgJk63qg3Wr0806pswNiYgDUXxwyryCEB8UBevtaSCCDHQoboKyoVvVzfRmL2napU0mrdbl8s//dy4+dM1M28n64FsPnIdz+XzO75zfOXA0pRRWU7o/uS9FxOc+3/vlIQBgq4F3fHxvKuIPJ9cFwi9uTXU8BwDa1Uaw/aN7UusCkWRbPI5yxcTI2Bgy49kXrkrwwIedqYg/nGyLXwsJiYHBYWTGs7Cq5Kpt4cA3PXft+2rX40vhrt7OVLgplIzHYuBKoH9gCKMjGVE1LdfJl86YDAAOfN2ziZP4NODyv9/z2fanFuH7P9iWCjcFk/FYK4QSGLgEk0WeUy/3mQCgPXFs9xbBRW883NrssDvQN3hWcOLPEPGWiD94MBaPQymBoaERjI9mBSfu+fHwL+biItpjR3e6JFfloDeAaGQ9SpUycvlp6ExHJBKGYsDvgyMYH81KTsL90yuX4VoWdh3pMqSQpWBjAC3RZkgpYEkCFDA8NIqJ0UlFxI3Tr/5aB9elsau305BcloKBAFpjLeBSYGRwDBNjk4oTN06/dnYZXCcAgK1vbzYkl6VwOATihOzYlOLEjTOvn1sRXiYAgDsP32YIKUuWaXFOwtP3xrnqleAVBQBwy/M3GZy4+PnN3/4TvqJgNWVVj2lNsCZYE6wJ1gRrgv9dYAMAHHw2Bl2fUEpBVavtLPVW/78nVR/Zk4CupzVHA6zChSOK0yHv0S8GFyK4BMPhAJxOgLE03/9kYhE2dz+agKaldY8bDaEQ7D5ft7Roy+UIlCooy5LQdaZ5vVBEgGmmrT172yVxaIylmdcDm9cHc2oK1Zm8kETvLAo0pRRk8mmnEqKouVw68zVCzP8F/uccFHHoXi/sjT6Y53Mw83mhOHn8J7416wQAwPftd0ouiswwdJu/CRASkBKQAmYuBzNfWIC/O173W6llwfbeu6Yi8tDsrAQJYGICyGQAIWDO5KUkaxlcJwAASdSmaWAQHCACOAc4h6YzJi1qWymNNUHlwYcT0JDWXQbACYhGgeh6gHM4Ghuh2/R0YePNiaUCTSmFcvdDCY1paZvhht3nQ2VmGmahICSR5vQHmDt6DcozeZSnp2FdLLZHhwdq94SVd+xMaJqWtrkM2L1uVHILpy0t8igidymXExfHMzBCQbhCIdga7Onz8etqkdgkUYTZbYCSqORmULlQEIq4J3jyexMA8jdu9BRzuaKyLN3udkNjDEqICID+2hbm797Wwez24/T3vJTE3aFTP9Sd9vT1NziVEMUGr1c35+Y2b5jKnqgNKqWglMLspjs6/rj1dudie2mdao07J5s3dCzt/werJTyI1yYqpQAAAABJRU5ErkJggg==) no-repeat 2px -34px;
    }

        /* Set to green check and text when valid */
        .input-help li.valid {
            color: #3a7d34;
            background-position: 2px 6px;
        }

    /* Set submit button */
    form .disn, form.ng-valid .btn[disabled] {
        display: none;
    }

    form.ng-invalid .btn[disabled], form.ng-valid .btn {
        /*margin-left: 400px;*/
        display: inline-block;
    }

    /*body {
 padding: 20px 0;   
}*/
    input {
        width: 166px;
    }
    /*.form-horizontal .control-label {
    width: 180px;
}*/
    /*.form-horizontal .controls {
  position: relative;
  margin-left: 200px;
}*/
</style>
<div class="row">
    <div class="col-md-12">
        <h3 class="page-title">Change Password</h3>
        <ul class="page-breadcrumb breadcrumb"></ul>
    </div>
</div>
<div class="clearfix"></div>
<script id="customMessageTemplate" type="text/html">
    <span class="validationError" data-bind='validationMessage: field'></span>
</script>
<div class="portlet-body">
    <div class="table-toolbar">
        <fieldset>

            <form ng-app="form-example" class="form-horizontal" novalidate>
                <div id="ChangePassword" data-bind="with: changepasswordModel">
                    <div class="form-wizard" data-bind='validationOptions: { messageTemplate: "customMessageTemplate" }'>
                        <div class="control-group">
                            <div class="controls">
                                <label class="control-label col-md-5" for="inputPassword">User Name :</label>
                                <label class="control-label displaytxt" id="loginusername">@ViewBag.UserName</label>
                                <input type="text" name="Username" style="display: none;"></input>
                                @*  <span class="username" id="loginusername">@Html.Encode(User.Identity.Name)</span>*@
                            </div>
                        </div>
                        <div class="control-group">
                            <div class="controls form-group">
                                <label class="control-label col-md-5" for="inputPassword">Current Password:</label>
                                <div class="col-md-3">
                                    <input class="immediate-help form-control" style="width: 100%; background: none;border: 0px;" id="loginpassword" disabled type="password" placeholder="Current Password" autocomplete="off" value=@ViewBag.PassWord">
                                    @*
                                    <label class="control-label displaytxt" type="password" style="display:none;" id="loginpassword">@ViewBag.PassWord</label>*@
                                    <label class="control-label displaytxt" id="logTransId" style="display:none;">@ViewBag.LogTransId</label>

                                    @*
                                    <input class="immediate-help form-control" style="width: 100%" type="password" placeholder="Current Password" data-bind="value: Password">*@
                                </div>
                            </div>
                        </div>

                        <div class="control-group">

                            <div class="controls form-group">
                                <label class="control-label col-md-5" for="inputPassword">New Password:</label>
                                <div class="col-md-3">
                                    <input ng-model="password" style="width: 100%" class="immediate-help form-control" password-validate required type="password" id="inputPassword" placeholder="New Password" data-bind="value: NewPassword" oncopy="return false" onpaste="return false" oncut="return false">
                                    <div class="input-help">
                                        <h4>New Password must meet the following requirements:</h4>
                                        <ul>
                                            <li ng-class="pwdUpperLetter">At least <strong>one upper letter</strong></li>
                                            <li ng-class="pwdLowerLetter">At least <strong>one lower letter</strong></li>
                                            <li ng-class="pwdHasNumber">At least <strong>one number</strong></li>
                                            <li ng-class="pwdSpecialChar">At least <strong>one special character</strong></li>
                                            <li ng-class="pwdValidLength">At least <strong>8 characters long</strong></li>

                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="control-group">
                            <div class="controls form-group">
                                <label class="control-label col-md-5" for="inputPassword">Confirm Password:</label>
                                <div class="col-md-3">
                                    <input class="immediate-help form-control" style="width: 100%" type="password" placeholder="Confirm Password" data-bind="value: ConfirmPassword" oncopy="return false" onpaste="return false" oncut="return false">
                                </div>
                            </div>
                        </div>
                        <div class="fluid">
                            <div class="row control-group ">
                                <div class="col-md-5">&nbsp;</div>
                                <div class="controls" style="padding: 10px">
                                    <a href="#" type="submit" class="disn btn btn-xs green" data-bind="click: $root.SubmitForgotPassword">Submit</a>
                                    <a href="#" class="disn btn btn-xs green" disabled data-bind="click: $root.SubmitForgotPassword">Submit</a>

                                </div>
                            </div>
                        </div>



                    </div>
                </div>

            </form>

        </fieldset>
    </div>
</div>
